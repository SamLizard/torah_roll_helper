
# Torah Roll Assistant â€“ Frontend

Frontend application that helps determine how many Torah pages to roll, based on:
- A photographed pasuk (via Dicta Illuminate)
- Or manual selection from upcoming readings

The app converts **references â†’ page numbers**, then computes **direction + number of pages** to roll.

---

## Tech Stack

- Vue 3
- TypeScript
- Vuetify
- Vite
- Static JSON data (generated by a separate data project)

No backend required.

---

## Core Concepts

### Everything is page numbers

Internally, the app only works with **page numbers**.

Any input (photo, manual choice, calendar reading) is eventually resolved to:
```ts
fromPage: number
toPage: number
```

All rolling logic is based on these values.

---

### Dicta is optional

The user is **not required** to take a photo.

The app supports:
- Manual â†’ Manual
- Photo â†’ Manual (default)
- Photo â†’ Photo (optional)
- Manual â†’ Photo

If Dicta fails or is unavailable, the app remains fully usable.

---

## App Structure

```
src/
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ FromPanel.vue
â”‚   â”œâ”€â”€ ToPanel.vue
â”‚   â”œâ”€â”€ RollResult.vue
â”‚   â”œâ”€â”€ DictaFrame.vue
â”‚   â””â”€â”€ TargetListDialog.vue
â”‚
â”œâ”€â”€ composables/
â”‚   â””â”€â”€ useAppState.ts
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ target_pages.json
â”‚   â””â”€â”€ calendar_data.json
â”‚
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ computeRoll.ts
â”‚   â”œâ”€â”€ getPageNumber.ts
â”‚   â”œâ”€â”€ getApproximatePages.ts
â”‚   â””â”€â”€ calendarUtils.ts
â”‚
â””â”€â”€ App.vue
```

---

## Global State

Managed via a simple composable (`useAppState`):

```ts
fromPage: number | null
toPage: number | null
calendarMode: \"israel\" | \"gola\"
```

Persisted values:
- Last selected TO target
- Israel / Gola mode

---

## User Flow (Default)

1. **FROM**
   - User takes a photo (Dicta)
2. **TO**
   - User selects a target from the list
3. App computes:
   - Number of pages
   - Direction to roll

The user can:
- Retake the photo without changing TO
- Switch Israel / Gola calendar
- Choose FROM manually instead of photo

---

## Dicta Integration

Dicta Illuminate is embedded via an iframe.

### Communication model

- Dicta writes its result to:
  - `window.postMessage` **or**
  - `localStorage`
- The frontend listens for updates
- The result is parsed into:
  - Pasuk reference (if available)
  - Chapter / book fallback otherwise

### Resolution logic

```text
Dicta result
â”‚
â”œâ”€ has verse â†’ getPageNumber()
â”‚
â””â”€ no verse â†’ getApproximatePages()
     â””â”€ user chooses page
```

Dicta never directly sets a page number.

---

## Approximate Pages

When Dicta returns a reference without a pasuk:
- A list of possible pages is displayed
- Each option shows:
  - Page number
  - Short preview
- The user selects the correct one

---

## Target Selection

### Quick list
- Next upcoming readings
- Sorted by date
- Israel / Gola aware

### Full list
- All entries from `target_pages.json`
- Full-screen dialog
- Searchable

The same dialog is reused for FROM and TO.

---

## Roll Computation

Handled by a single utility:

```ts
computeRoll(fromPage, toPage)
```

Returns:
```ts
{
  pages: number
  direction: \"forward\" | \"backward\"
}
```

Displayed prominently for real-world synagogue use.

---

## Development

### Install

```bash
npm install
```

### Run

```bash
npm run dev
```

---

## Design Principles

- No hidden magic
- No backend dependency
- Page numbers are the single source of truth
- Dicta enhances accuracy but never blocks usage
- UX optimized for quick, real-life decisions

---

## Related Projects

- Data generation project (JSON + utils)
- Dicta Illuminate
- Tikun / Sefaria data sources

---

## Status

ðŸš§ Active development  
Frontend is built incrementally following a defined roadmap.